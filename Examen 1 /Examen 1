#include <stdio.h>
#include <stdlib.h>

int main() {
    int n, i, nuevos;
    float *calificaciones = NULL;
    float suma = 0.0, promedio = 0.0;

    printf("¿Cuántos estudiantes deseas registrar? ");
    scanf("%d", &n);

    calificaciones = (float *)malloc(n * sizeof(float));

    if (calificaciones == NULL) {
        printf("Error: no se pudo asignar memoria.\n");
        return 1;
    }

    for (i = 0; i < n; i++) {
        printf("Calificación del estudiante %d: ", i + 1);
        scanf("%f", &calificaciones[i]);
        suma += calificaciones[i];
    }

    promedio = suma / n;
    printf("\nPromedio inicial: %.2f\n", promedio);

    printf("\n¿Deseas agregar más estudiantes? (cantidad, 0 para no): ");
    scanf("%d", &nuevos);

    if (nuevos > 0) {
        float *temp = realloc(calificaciones, (n + nuevos) * sizeof(float));

        if (temp == NULL) {
            printf("Error: no se pudo ampliar la memoria.\n");
            free(calificaciones);
            return 1;
        }

        calificaciones = temp;

        for (i = n; i < n + nuevos; i++) {
            printf("Calificación del estudiante %d: ", i + 1);
            scanf("%f", &calificaciones[i]);
            suma += calificaciones[i];
        }

        promedio = suma / (n + nuevos);
        n += nuevos;
    }

    printf("\n=== Calificaciones registradas ===\n");
    for (i = 0; i < n; i++) {
        printf("Estudiante %d: %.2f\n", i + 1, calificaciones[i]);
    }

    printf("Promedio general: %.2f\n", promedio);

    free(calificaciones);
    printf("\nMemoria liberada correctamente.\n");

    return 0;
}
